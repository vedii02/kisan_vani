{"ast":null,"code":"var _jsxFileName = \"D:\\\\Vedi_Practice\\\\AI\\\\kisan_vani\\\\frontend\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport { Mic, MicOff, Volume2 } from 'lucide-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function App() {\n  _s();\n  const [isListening, setIsListening] = useState(false);\n  const [text, setText] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [selectedLanguage, setSelectedLanguage] = useState('hi-IN');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const audioRef = useRef(new Audio());\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const streamRef = useRef(null);\n  const languages = [{\n    code: 'hi-IN',\n    name: '‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)',\n    flag: 'üáÆüá≥'\n  }, {\n    code: 'en-US',\n    name: 'English',\n    flag: 'üá∫üá∏'\n  }, {\n    code: 'mr-IN',\n    name: '‡§Æ‡§∞‡§æ‡§†‡•Ä (Marathi)',\n    flag: 'üáÆüá≥'\n  }, {\n    code: 'gu-IN',\n    name: '‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä (Gujarati)',\n    flag: 'üáÆüá≥'\n  }, {\n    code: 'bn-IN',\n    name: '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)',\n    flag: 'üáÆüá≥'\n  }, {\n    code: 'te-IN',\n    name: '‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)',\n    flag: 'üáÆüá≥'\n  }, {\n    code: 'ta-IN',\n    name: '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (Tamil)',\n    flag: 'üáÆüá≥'\n  }, {\n    code: 'kn-IN',\n    name: '‡≤ï‡≤®‡≥ç‡≤®‡≤° (Kannada)',\n    flag: 'üáÆüá≥'\n  }, {\n    code: 'ml-IN',\n    name: '‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç (Malayalam)',\n    flag: 'üáÆüá≥'\n  }, {\n    code: 'pa-IN',\n    name: '‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä (Punjabi)',\n    flag: 'üáÆüá≥'\n  }];\n\n  // Start Recording\n  const startListening = async () => {\n    try {\n      console.log('üé§ Requesting microphone access...');\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          channelCount: 1,\n          sampleRate: 48000,\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          volume: 1.0\n        }\n      });\n      streamRef.current = stream;\n      console.log('‚úÖ Microphone access granted');\n\n      // Use best available format for Google STT\n      let mimeType;\n      if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {\n        mimeType = 'audio/webm;codecs=opus';\n      } else if (MediaRecorder.isTypeSupported('audio/webm')) {\n        mimeType = 'audio/webm';\n      } else if (MediaRecorder.isTypeSupported('audio/ogg;codecs=opus')) {\n        mimeType = 'audio/ogg;codecs=opus';\n      } else {\n        mimeType = 'audio/ogg';\n      }\n      console.log('üìº Using MIME type:', mimeType);\n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType,\n        audioBitsPerSecond: 128000 // Higher quality\n      });\n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n      mediaRecorder.ondataavailable = e => {\n        if (e.data.size > 0) {\n          console.log('üì¶ Audio chunk:', e.data.size, 'bytes');\n          audioChunksRef.current.push(e.data);\n        }\n      };\n      mediaRecorder.onstop = async () => {\n        console.log('üõë Recording stopped');\n        console.log('üì¶ Total chunks:', audioChunksRef.current.length);\n\n        // Stop all tracks\n        if (streamRef.current) {\n          streamRef.current.getTracks().forEach(track => {\n            track.stop();\n            console.log('üîå Track stopped:', track.kind);\n          });\n          streamRef.current = null;\n        }\n        if (audioChunksRef.current.length === 0) {\n          alert('‚ùå No audio recorded. Please try again.');\n          return;\n        }\n        const audioBlob = new Blob(audioChunksRef.current, {\n          type: mimeType\n        });\n        console.log('üéµ Audio blob size:', audioBlob.size, 'bytes');\n        console.log('üéµ Audio MIME type:', audioBlob.type);\n        if (audioBlob.size < 5000) {\n          alert('‚ö†Ô∏è Audio too short. Please speak louder and for at least 3 seconds.');\n          return;\n        }\n\n        // Convert to base64 and send\n        const base64Audio = await blobToBase64(audioBlob);\n        await processVoiceMessage(base64Audio);\n      };\n\n      // Start recording (collect chunks every 250ms for better quality)\n      mediaRecorder.start(250);\n      setIsListening(true);\n      console.log('üî¥ Recording started - Speak now!');\n    } catch (err) {\n      console.error('‚ùå Microphone error:', err);\n      if (err.name === 'NotAllowedError') {\n        alert('üé§ Microphone permission denied. Please allow microphone access.');\n      } else if (err.name === 'NotFoundError') {\n        alert('üé§ No microphone found. Please connect a microphone.');\n      } else {\n        alert(`‚ùå Error: ${err.message}`);\n      }\n    }\n  };\n  const startWebSpeech = () => {\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n    const recognition = new SpeechRecognition();\n    recognition.lang = selectedLanguage;\n    recognition.start();\n    recognition.onresult = e => {\n      const text = e.results[0][0].transcript;\n      console.log('Heard:', text);\n      // Send to chat API\n    };\n  };\n  // Stop Recording\n  const stopListening = () => {\n    const recorder = mediaRecorderRef.current;\n    if (!recorder) {\n      console.log('‚ö†Ô∏è No active recorder');\n      return;\n    }\n    if (recorder.state === 'recording') {\n      console.log('üõë Stopping recorder...');\n      recorder.stop();\n      setIsListening(false);\n    } else {\n      console.log('‚ö†Ô∏è Recorder not in recording state:', recorder.state);\n    }\n  };\n\n  // Process Voice: STT ‚Üí Chat ‚Üí TTS\n  const processVoiceMessage = async audioBase64 => {\n    try {\n      setIsProcessing(true);\n      console.log('üì§ Sending to STT API...');\n      console.log('üìä Audio base64 length:', audioBase64.length);\n\n      // Step 1: Speech to Text\n      const sttRes = await fetch('http://localhost:8000/voice/stt', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          audio: audioBase64,\n          language: selectedLanguage\n        })\n      });\n      console.log('üì• STT Response status:', sttRes.status);\n      if (!sttRes.ok) {\n        const errorText = await sttRes.text();\n        console.error('‚ùå STT failed:', errorText);\n        throw new Error(`STT failed: ${sttRes.status} - ${errorText}`);\n      }\n      const sttData = await sttRes.json();\n      console.log('‚úÖ STT Response:', sttData);\n      if (!sttData.text || sttData.text.trim() === '') {\n        alert('üîá Could not understand. Please speak clearly and try again.');\n        setIsProcessing(false);\n        return;\n      }\n\n      // Show transcribed text\n      console.log('üìù Transcribed text:', sttData.text);\n      setText(sttData.text);\n      const userMsg = {\n        role: 'user',\n        content: sttData.text\n      };\n      setMessages(prev => [...prev, userMsg]);\n\n      // Step 2: Get AI Response\n      console.log('ü§ñ Getting AI response...');\n      const chatRes = await fetch('http://localhost:8000/voice/chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          message: sttData.text,\n          language: selectedLanguage,\n          farmer_id: 'farmer_123',\n          farmer_name: 'Ramesh Kumar'\n        })\n      });\n      if (!chatRes.ok) {\n        throw new Error(`Chat failed: ${chatRes.status}`);\n      }\n      const chatData = await chatRes.json();\n      console.log('‚úÖ AI Response:', chatData.response);\n      const aiMsg = {\n        role: 'assistant',\n        content: chatData.response\n      };\n      setMessages(prev => [...prev, aiMsg]);\n\n      // Step 3: Play AI voice\n      if (chatData.audio) {\n        console.log('üîä Playing AI voice...');\n        playAudio(chatData.audio);\n      } else {\n        console.log('‚ö†Ô∏è No audio in response');\n      }\n    } catch (err) {\n      console.error('‚ùå Voice processing error:', err);\n      alert(`‚ùå Error: ${err.message}`);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // Manual Text Send\n  const sendMessage = async () => {\n    if (!text.trim()) return;\n    const userMsg = {\n      role: 'user',\n      content: text\n    };\n    setMessages(prev => [...prev, userMsg]);\n    const messageText = text;\n    setText('');\n    setIsProcessing(true);\n    try {\n      const res = await fetch('http://localhost:8000/voice/chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          message: messageText,\n          language: selectedLanguage,\n          farmer_id: 'farmer_123',\n          farmer_name: 'Ramesh Kumar'\n        })\n      });\n      const data = await res.json();\n      const aiMsg = {\n        role: 'assistant',\n        content: data.response\n      };\n      setMessages(prev => [...prev, aiMsg]);\n      if (data.audio) {\n        playAudio(data.audio);\n      }\n    } catch (err) {\n      console.error(err);\n      alert('Failed to send message');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // Play Audio\n  const playAudio = base64Audio => {\n    try {\n      setIsSpeaking(true);\n      const audioBlob = base64ToBlob(base64Audio, 'audio/mp3');\n      const audioUrl = URL.createObjectURL(audioBlob);\n      audioRef.current.src = audioUrl;\n      audioRef.current.onended = () => {\n        setIsSpeaking(false);\n        URL.revokeObjectURL(audioUrl);\n      };\n      audioRef.current.onerror = e => {\n        console.error('Audio play error:', e);\n        setIsSpeaking(false);\n      };\n      audioRef.current.play().catch(err => {\n        console.error('Play failed:', err);\n        setIsSpeaking(false);\n      });\n      console.log('‚ñ∂Ô∏è Audio playing');\n    } catch (err) {\n      console.error('Audio play error:', err);\n      setIsSpeaking(false);\n    }\n  };\n\n  // Helpers\n  const blobToBase64 = blob => new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      const base64 = reader.result.split(',')[1];\n      console.log('‚úÖ Converted to base64, length:', base64.length);\n      resolve(base64);\n    };\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n  const base64ToBlob = (b64, mime) => {\n    const bytes = atob(b64);\n    const arr = new Uint8Array(bytes.length);\n    for (let i = 0; i < bytes.length; i++) arr[i] = bytes.charCodeAt(i);\n    return new Blob([arr], {\n      type: mime\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 p-6 flex flex-col items-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-4xl font-bold mb-8 text-green-700\",\n      children: \"KisanAI \\uD83C\\uDF3E\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col items-center gap-4 mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: isListening ? stopListening : startListening,\n        disabled: isProcessing,\n        className: `w-20 h-20 rounded-full flex items-center justify-center text-white shadow-xl transition-all ${isListening ? 'bg-red-500 animate-pulse scale-110' : isProcessing ? 'bg-gray-400' : 'bg-green-500 hover:scale-110 hover:shadow-2xl'}`,\n        children: isListening ? /*#__PURE__*/_jsxDEV(MicOff, {\n          size: 32\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 26\n        }, this) : /*#__PURE__*/_jsxDEV(Mic, {\n          size: 32\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 49\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this), isListening && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-red-600 font-bold animate-pulse\",\n        children: \"\\uD83D\\uDD34 Recording... Click to stop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 11\n      }, this), isProcessing && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-blue-600 font-bold\",\n        children: \"\\u23F3 Processing...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 11\n      }, this), isSpeaking && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 text-purple-600 font-bold\",\n        children: [/*#__PURE__*/_jsxDEV(Volume2, {\n          className: \"animate-pulse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 13\n        }, this), \"Speaking...\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: selectedLanguage,\n        onChange: e => setSelectedLanguage(e.target.value),\n        className: \"px-6 py-3 rounded-lg border-2 border-green-300 text-lg font-semibold\",\n        disabled: isListening || isProcessing,\n        children: languages.map(lang => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: lang.code,\n          children: [lang.flag, \" \", lang.name]\n        }, lang.code, true, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-2xl mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: text,\n        onChange: e => setText(e.target.value),\n        placeholder: \"Or type your message here...\",\n        className: \"w-full p-4 border-2 border-green-200 rounded-xl text-lg resize-none\",\n        rows: 3\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: sendMessage,\n        disabled: isProcessing || !text.trim(),\n        className: \"mt-2 w-full bg-green-500 text-white px-6 py-3 rounded-xl hover:bg-green-600 disabled:bg-gray-300 font-bold\",\n        children: \"Send Message\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-2xl flex flex-col gap-4\",\n      children: messages.map((msg, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `p-4 rounded-xl shadow-md ${msg.role === 'user' ? 'bg-purple-100 self-end max-w-[80%]' : 'bg-green-100 self-start max-w-[80%]'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-bold text-sm mb-1\",\n          children: msg.role === 'user' ? 'üë®‚Äçüåæ You' : 'ü§ñ KisanAI'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg\",\n          children: msg.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 13\n        }, this)]\n      }, idx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 320,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"NME9p2RcVIq6jI5cNm+vsYhw+0c=\");\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useRef","Mic","MicOff","Volume2","jsxDEV","_jsxDEV","App","_s","isListening","setIsListening","text","setText","messages","setMessages","selectedLanguage","setSelectedLanguage","isProcessing","setIsProcessing","isSpeaking","setIsSpeaking","audioRef","Audio","mediaRecorderRef","audioChunksRef","streamRef","languages","code","name","flag","startListening","console","log","stream","navigator","mediaDevices","getUserMedia","audio","channelCount","sampleRate","echoCancellation","noiseSuppression","autoGainControl","volume","current","mimeType","MediaRecorder","isTypeSupported","mediaRecorder","audioBitsPerSecond","ondataavailable","e","data","size","push","onstop","length","getTracks","forEach","track","stop","kind","alert","audioBlob","Blob","type","base64Audio","blobToBase64","processVoiceMessage","start","err","error","message","startWebSpeech","SpeechRecognition","window","webkitSpeechRecognition","recognition","lang","onresult","results","transcript","stopListening","recorder","state","audioBase64","sttRes","fetch","method","headers","body","JSON","stringify","language","status","ok","errorText","Error","sttData","json","trim","userMsg","role","content","prev","chatRes","farmer_id","farmer_name","chatData","response","aiMsg","playAudio","sendMessage","messageText","res","base64ToBlob","audioUrl","URL","createObjectURL","src","onended","revokeObjectURL","onerror","play","catch","blob","Promise","resolve","reject","reader","FileReader","onloadend","base64","result","split","readAsDataURL","b64","mime","bytes","atob","arr","Uint8Array","i","charCodeAt","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","value","onChange","target","map","placeholder","rows","msg","idx","_c","$RefreshReg$"],"sources":["D:/Vedi_Practice/AI/kisan_vani/frontend/src/App.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport { Mic, MicOff, Volume2 } from 'lucide-react';\n\nexport default function App() {\n  const [isListening, setIsListening] = useState(false);\n  const [text, setText] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [selectedLanguage, setSelectedLanguage] = useState('hi-IN');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n\n  const audioRef = useRef(new Audio());\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const streamRef = useRef(null);\n\n  const languages = [\n    { code: 'hi-IN', name: '‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)', flag: 'üáÆüá≥' },\n    { code: 'en-US', name: 'English', flag: 'üá∫üá∏' },\n    { code: 'mr-IN', name: '‡§Æ‡§∞‡§æ‡§†‡•Ä (Marathi)', flag: 'üáÆüá≥' },\n    { code: 'gu-IN', name: '‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä (Gujarati)', flag: 'üáÆüá≥' },\n    { code: 'bn-IN', name: '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)', flag: 'üáÆüá≥' },\n    { code: 'te-IN', name: '‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)', flag: 'üáÆüá≥' },\n    { code: 'ta-IN', name: '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (Tamil)', flag: 'üáÆüá≥' },\n    { code: 'kn-IN', name: '‡≤ï‡≤®‡≥ç‡≤®‡≤° (Kannada)', flag: 'üáÆüá≥' },\n    { code: 'ml-IN', name: '‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç (Malayalam)', flag: 'üáÆüá≥' },\n    { code: 'pa-IN', name: '‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä (Punjabi)', flag: 'üáÆüá≥' }\n  ];\n\n  // Start Recording\n  const startListening = async () => {\n    try {\n      console.log('üé§ Requesting microphone access...');\n      \n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          channelCount: 1,\n          sampleRate: 48000,\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          volume: 1.0\n        }\n      });\n\n      streamRef.current = stream;\n      console.log('‚úÖ Microphone access granted');\n\n      // Use best available format for Google STT\n      let mimeType;\n      if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {\n        mimeType = 'audio/webm;codecs=opus';\n      } else if (MediaRecorder.isTypeSupported('audio/webm')) {\n        mimeType = 'audio/webm';\n      } else if (MediaRecorder.isTypeSupported('audio/ogg;codecs=opus')) {\n        mimeType = 'audio/ogg;codecs=opus';\n      } else {\n        mimeType = 'audio/ogg';\n      }\n\n      console.log('üìº Using MIME type:', mimeType);\n\n      const mediaRecorder = new MediaRecorder(stream, { \n        mimeType,\n        audioBitsPerSecond: 128000 // Higher quality\n      });\n      \n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n\n      mediaRecorder.ondataavailable = (e) => {\n        if (e.data.size > 0) {\n          console.log('üì¶ Audio chunk:', e.data.size, 'bytes');\n          audioChunksRef.current.push(e.data);\n        }\n      };\n\n      mediaRecorder.onstop = async () => {\n        console.log('üõë Recording stopped');\n        console.log('üì¶ Total chunks:', audioChunksRef.current.length);\n        \n        // Stop all tracks\n        if (streamRef.current) {\n          streamRef.current.getTracks().forEach(track => {\n            track.stop();\n            console.log('üîå Track stopped:', track.kind);\n          });\n          streamRef.current = null;\n        }\n        \n        if (audioChunksRef.current.length === 0) {\n          alert('‚ùå No audio recorded. Please try again.');\n          return;\n        }\n\n        const audioBlob = new Blob(audioChunksRef.current, { type: mimeType });\n        console.log('üéµ Audio blob size:', audioBlob.size, 'bytes');\n        console.log('üéµ Audio MIME type:', audioBlob.type);\n\n        if (audioBlob.size < 5000) {\n          alert('‚ö†Ô∏è Audio too short. Please speak louder and for at least 3 seconds.');\n          return;\n        }\n\n        // Convert to base64 and send\n        const base64Audio = await blobToBase64(audioBlob);\n        await processVoiceMessage(base64Audio);\n      };\n\n      // Start recording (collect chunks every 250ms for better quality)\n      mediaRecorder.start(250);\n      setIsListening(true);\n      console.log('üî¥ Recording started - Speak now!');\n\n    } catch (err) {\n      console.error('‚ùå Microphone error:', err);\n      if (err.name === 'NotAllowedError') {\n        alert('üé§ Microphone permission denied. Please allow microphone access.');\n      } else if (err.name === 'NotFoundError') {\n        alert('üé§ No microphone found. Please connect a microphone.');\n      } else {\n        alert(`‚ùå Error: ${err.message}`);\n      }\n    }\n  };\nconst startWebSpeech = () => {\n  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n  const recognition = new SpeechRecognition();\n  recognition.lang = selectedLanguage;\n  recognition.start();\n  recognition.onresult = (e) => {\n    const text = e.results[0][0].transcript;\n    console.log('Heard:', text);\n    // Send to chat API\n  };\n};\n  // Stop Recording\n  const stopListening = () => {\n    const recorder = mediaRecorderRef.current;\n    \n    if (!recorder) {\n      console.log('‚ö†Ô∏è No active recorder');\n      return;\n    }\n\n    if (recorder.state === 'recording') {\n      console.log('üõë Stopping recorder...');\n      recorder.stop();\n      setIsListening(false);\n    } else {\n      console.log('‚ö†Ô∏è Recorder not in recording state:', recorder.state);\n    }\n  };\n\n  // Process Voice: STT ‚Üí Chat ‚Üí TTS\n  const processVoiceMessage = async (audioBase64) => {\n    try {\n      setIsProcessing(true);\n      console.log('üì§ Sending to STT API...');\n      console.log('üìä Audio base64 length:', audioBase64.length);\n\n      // Step 1: Speech to Text\n      const sttRes = await fetch('http://localhost:8000/voice/stt', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          audio: audioBase64,\n          language: selectedLanguage\n        })\n      });\n\n      console.log('üì• STT Response status:', sttRes.status);\n\n      if (!sttRes.ok) {\n        const errorText = await sttRes.text();\n        console.error('‚ùå STT failed:', errorText);\n        throw new Error(`STT failed: ${sttRes.status} - ${errorText}`);\n      }\n\n      const sttData = await sttRes.json();\n      console.log('‚úÖ STT Response:', sttData);\n\n      if (!sttData.text || sttData.text.trim() === '') {\n        alert('üîá Could not understand. Please speak clearly and try again.');\n        setIsProcessing(false);\n        return;\n      }\n\n      // Show transcribed text\n      console.log('üìù Transcribed text:', sttData.text);\n      setText(sttData.text);\n      const userMsg = { role: 'user', content: sttData.text };\n      setMessages(prev => [...prev, userMsg]);\n\n      // Step 2: Get AI Response\n      console.log('ü§ñ Getting AI response...');\n      const chatRes = await fetch('http://localhost:8000/voice/chat', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          message: sttData.text,\n          language: selectedLanguage,\n          farmer_id: 'farmer_123',\n          farmer_name: 'Ramesh Kumar'\n        })\n      });\n\n      if (!chatRes.ok) {\n        throw new Error(`Chat failed: ${chatRes.status}`);\n      }\n\n      const chatData = await chatRes.json();\n      console.log('‚úÖ AI Response:', chatData.response);\n\n      const aiMsg = { role: 'assistant', content: chatData.response };\n      setMessages(prev => [...prev, aiMsg]);\n\n      // Step 3: Play AI voice\n      if (chatData.audio) {\n        console.log('üîä Playing AI voice...');\n        playAudio(chatData.audio);\n      } else {\n        console.log('‚ö†Ô∏è No audio in response');\n      }\n\n    } catch (err) {\n      console.error('‚ùå Voice processing error:', err);\n      alert(`‚ùå Error: ${err.message}`);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // Manual Text Send\n  const sendMessage = async () => {\n    if (!text.trim()) return;\n\n    const userMsg = { role: 'user', content: text };\n    setMessages(prev => [...prev, userMsg]);\n    const messageText = text;\n    setText('');\n    setIsProcessing(true);\n\n    try {\n      const res = await fetch('http://localhost:8000/voice/chat', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          message: messageText,\n          language: selectedLanguage,\n          farmer_id: 'farmer_123',\n          farmer_name: 'Ramesh Kumar'\n        })\n      });\n\n      const data = await res.json();\n      const aiMsg = { role: 'assistant', content: data.response };\n      setMessages(prev => [...prev, aiMsg]);\n\n      if (data.audio) {\n        playAudio(data.audio);\n      }\n\n    } catch (err) {\n      console.error(err);\n      alert('Failed to send message');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // Play Audio\n  const playAudio = (base64Audio) => {\n    try {\n      setIsSpeaking(true);\n      const audioBlob = base64ToBlob(base64Audio, 'audio/mp3');\n      const audioUrl = URL.createObjectURL(audioBlob);\n      \n      audioRef.current.src = audioUrl;\n      audioRef.current.onended = () => {\n        setIsSpeaking(false);\n        URL.revokeObjectURL(audioUrl);\n      };\n      audioRef.current.onerror = (e) => {\n        console.error('Audio play error:', e);\n        setIsSpeaking(false);\n      };\n      audioRef.current.play().catch(err => {\n        console.error('Play failed:', err);\n        setIsSpeaking(false);\n      });\n      console.log('‚ñ∂Ô∏è Audio playing');\n    } catch (err) {\n      console.error('Audio play error:', err);\n      setIsSpeaking(false);\n    }\n  };\n\n  // Helpers\n  const blobToBase64 = (blob) =>\n    new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        const base64 = reader.result.split(',')[1];\n        console.log('‚úÖ Converted to base64, length:', base64.length);\n        resolve(base64);\n      };\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n\n  const base64ToBlob = (b64, mime) => {\n    const bytes = atob(b64);\n    const arr = new Uint8Array(bytes.length);\n    for (let i = 0; i < bytes.length; i++) arr[i] = bytes.charCodeAt(i);\n    return new Blob([arr], { type: mime });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 p-6 flex flex-col items-center\">\n      <h1 className=\"text-4xl font-bold mb-8 text-green-700\">KisanAI üåæ</h1>\n\n      {/* Voice Button */}\n      <div className=\"flex flex-col items-center gap-4 mb-6\">\n        <button\n          onClick={isListening ? stopListening : startListening}\n          disabled={isProcessing}\n          className={`w-20 h-20 rounded-full flex items-center justify-center text-white shadow-xl transition-all ${\n            isListening \n              ? 'bg-red-500 animate-pulse scale-110' \n              : isProcessing\n              ? 'bg-gray-400'\n              : 'bg-green-500 hover:scale-110 hover:shadow-2xl'\n          }`}\n        >\n          {isListening ? <MicOff size={32} /> : <Mic size={32} />}\n        </button>\n\n        {isListening && (\n          <p className=\"text-red-600 font-bold animate-pulse\">\n            üî¥ Recording... Click to stop\n          </p>\n        )}\n\n        {isProcessing && (\n          <p className=\"text-blue-600 font-bold\">\n            ‚è≥ Processing...\n          </p>\n        )}\n\n        {isSpeaking && (\n          <div className=\"flex items-center gap-2 text-purple-600 font-bold\">\n            <Volume2 className=\"animate-pulse\" />\n            Speaking...\n          </div>\n        )}\n\n        <select\n          value={selectedLanguage}\n          onChange={(e) => setSelectedLanguage(e.target.value)}\n          className=\"px-6 py-3 rounded-lg border-2 border-green-300 text-lg font-semibold\"\n          disabled={isListening || isProcessing}\n        >\n          {languages.map((lang) => (\n            <option key={lang.code} value={lang.code}>\n              {lang.flag} {lang.name}\n            </option>\n          ))}\n        </select>\n      </div>\n\n      {/* Text Input */}\n      <div className=\"w-full max-w-2xl mb-6\">\n        <textarea\n          value={text}\n          onChange={(e) => setText(e.target.value)}\n          placeholder=\"Or type your message here...\"\n          className=\"w-full p-4 border-2 border-green-200 rounded-xl text-lg resize-none\"\n          rows={3}\n        />\n        <button\n          onClick={sendMessage}\n          disabled={isProcessing || !text.trim()}\n          className=\"mt-2 w-full bg-green-500 text-white px-6 py-3 rounded-xl hover:bg-green-600 disabled:bg-gray-300 font-bold\"\n        >\n          Send Message\n        </button>\n      </div>\n\n      {/* Messages */}\n      <div className=\"w-full max-w-2xl flex flex-col gap-4\">\n        {messages.map((msg, idx) => (\n          <div\n            key={idx}\n            className={`p-4 rounded-xl shadow-md ${\n              msg.role === 'user'\n                ? 'bg-purple-100 self-end max-w-[80%]'\n                : 'bg-green-100 self-start max-w-[80%]'\n            }`}\n          >\n            <div className=\"font-bold text-sm mb-1\">\n              {msg.role === 'user' ? 'üë®‚Äçüåæ You' : 'ü§ñ KisanAI'}\n            </div>\n            <div className=\"text-lg\">{msg.content}</div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}